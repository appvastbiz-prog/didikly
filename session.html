<!DOCTYPE html>
<html>
<body>

<h2>Session</h2>
<p id="info"></p>
<a href="/review.html?session=${id}">Leave review</a>
<p>Video coming next.</p>

<script type="module">

  import { requireRole } from "./guard.js";

  const access = await requireRole(["student", "tutor"]);
  if (!access.ok) {
    document.body.innerHTML = "Access denied";
    throw new Error("Blocked");
  }
  
  import { supabase } from "./supabase.js";

  const params = new URLSearchParams(window.location.search);
  const id = params.get("id");

  async function load() {
    const { data: session } = await supabase
      .from("sessions")
      .select("*")
      .eq("id", id)
      .single();

    document.getElementById("info").innerHTML = `
  Session ID: ${id} | Mode: ${session.mode}
  <br><br>
  <a href="/review.html?session=${id}">Leave review</a>
`;


  load();
</script>

</body>
</html>
